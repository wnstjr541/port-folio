$(window).load(function() {
/* SCROLL STICKY KEEP AFTER REFRESH*/
	var stickyHeaderTop = $('#head_nav').offset().top;
	$(window).scroll(function(e) {
		 e.preventDefault();
		if ($(this).scrollTop() > stickyHeaderTop) {
			$('#head_nav').addClass('sticky');
			$('a.aro_top').fadeIn();
		} else {
			$('#head_nav').removeClass('sticky');
			$('a.aro_top').fadeOut();
		}
	});

/* HEADMNENU */
	$('div.drop_container').hide();
	// function for mouse hover
	$('.drop').hover(function() {
		$(this).find('div.drop_container').show(0);
		$('#drop_dimm').show(0);
	}, function() {
		$(this).find('div.drop_container').delay(100).hide(0);
		$('#drop_dimm').hide(0);
	});
	//function for people using tabs
	$('.drop a').focus(function() {
		$(this).closest("li.drop").find('div.drop_container').stop(true, true).delay(0).slideDown('fast');
	});
	$('.drop a').blur(function() {
		$(this).closest("li.drop").find('div.drop_container').stop(true, true).delay(0).slideUp('fast');
	});
/* FOOTLINKS start*/
	$('.push h3 a').on('click', function(){

        var fnum = $('.push h3 a').index(this);
        if($(this).hasClass('on')){
            $('div.push_container').eq(fnum).slideUp({
                    duration: 800,
                    easing: "easeInOutQuart"
                });

            $(this).removeClass('on');
        }else{
            $('.push h3 a').removeClass('on');
            $('div.push_container').hide();
            $(this).addClass('on');
            $('div.push_container').eq(fnum).slideDown({
				duration: 400,
				easing: "easeInOutQuart"
			});
        }
        return false;
	});
	var push_timeout;
	$(document).on({
		mouseenter: function() {
			clearTimeout(push_timeout)
		},
		mouseleave: function() {
			$push = $('div.push_container')
			push_timeout = setTimeout(function() {
				$push.slideUp('slow');
				$('.push h3 a').removeClass('on');
			}, 1200)
		},
	}, "#foot_linkset")

	//function for people using tabs
		$("div.push_container .last a").blur(function () {
        $('.push h3 a').removeClass('on');
		$('div.push_container').hide();
	});
/* end FOOTLINKS */

	$('a.aro_top').click(function(e) {
		e.preventDefault();
		$('body,html').animate({
			scrollTop: 0
		}, 500);
	});
/* FINDEROPEN */
	$('a.finder_open').on('click',function(e){
		$("#finder_open_div").toggle(0);
		$("#finder_open_mask").toggleClass('on');
		e.preventDefault();
	});
	$('a.finder_close').on('click',function(e){
		$("#finder_open_div").hide(0);
		$("#finder_open_mask").removeClass('on');
		$(".finder_open").attr("tabindex", 0).focus();
		e.preventDefault();
	});
	var find_timeout;
	$(document).on({
		mouseenter: function() {
			clearTimeout(find_timeout)
		},
		mouseleave: function() {
			$find = $('#finder_open_div')
			find_timeout = setTimeout(function() {
				$find.hide(0);
				$('#finder_open_mask').removeClass('on');
			}, 3000)
		},
	}, "#finder_open_div");

	$(document).on('mouseup',function(e){
		if (
		!$(e.target).is('#finder_open_div') &&
		!$(e.target).parents().is('#finder_open_div') &&
		!$(e.target).hasClass('finder_close,finder_open')){
			$('#finder_open_div').hide(0);
			$('#finder_open_mask').removeClass('on');
		}
	});//외부 클릭시 레이어닫기



//#mysBox open
	$('#mysBox').hide();
	$('a#mysBtn').click(function(e){
		$("#mysBox").slideToggle(330);
		$(this).toggleClass('active');
		e.preventDefault();
	});
	var mys_timeout;
	$(document).on({
		mouseenter: function() {
			clearTimeout(mys_timeout)
		},
		mouseleave: function() {
			$mys = $('#mysBox')
			mys_timeout = setTimeout(function() {
				$mys.slideUp();
			$('a#mysBtn').removeClass('active');
		}, 2000)
		},
	}, "#mys")
/*end*/
//open_hop open

	$(".open_hop").click(function(){
		$('body').append('<div class="hop_dimm"></div>');
		$('body').addClass('fixed');
	});

	$(".close_hop").click(function(){
		$('body').removeClass('fixed');
		$('.hop_dimm').remove();
		// AFTER POP CLOSE WITH KEY
		$('#google_translate_element').attr('tabindex', '0').focus();
		$("#mysBox").slideUp(150);
		e.preventDefault();
	});

	$(".hop_dimm").click(function(){
		$('body').removeClass('fixed');
		$(this).remove();
	});


	$(document).click(function(event) {
	//if you click on anything except the modal itself or the "open modal" link, close the modal
		if (!$(event.target).closest(".hop_wrap,.open_hop").length) {
			$('body').removeClass('fixed');
			$('.hop_dimm').remove();
		}
	});

//bnrdiv open

	/*$(".open_bnrdiv").click(function(){
		$('body').append('<div class="bnrdiv_dimm"></div>');
		$('body').addClass('bnrdiv_back');
		$(".bnrdiv_wrap").attr("tabindex", 0).focus();
	});*/
	$(".open_bnrdiv#btn_bnrdiv_main").click(function(){
		$('body').append('<div class="bnrdiv_dimm"></div>');
		$('body').addClass('bnrdiv_back_1');
		$(".bnrdiv_wrap#bnrdiv_main").attr("tabindex", 0).focus();
	});
	$(".open_bnrdiv#btn_bnrdiv_sub").click(function(){
		$('body').append('<div class="bnrdiv_dimm"></div>');
		$('body').addClass('bnrdiv_back_2');
		$(".bnrdiv_wrap#bnrdiv_sub").attr("tabindex", 0).focus();
	});

	$(".close_bnrdiv#bnrdiv_main_x").click(function(){
		$('body').removeClass('bnrdiv_back_1');
		$('.bnrdiv_dimm').remove();
		$(".open_bnrdiv#btn_bnrdiv_main").attr("tabindex", 0).focus();
		e.preventDefault();
	});
	$(".close_bnrdiv#bnrdiv_sub_x").click(function(){
		$('body').removeClass('bnrdiv_back_2');
		$('.bnrdiv_dimm').remove();
		$(".open_bnrdiv#btn_bnrdiv_sub").attr("tabindex", 0).focus();
		e.preventDefault();
	});
	$(".bnrdiv_dimm").click(function(){
		$('body').removeClass('bnrdiv_back_1');
		$('body').removeClass('bnrdiv_back_2');
		$(this).remove();
	});
	$(document).click(function(event) {
	//if you click on anything except the modal itself or the "open modal" link, close the modal
		if (!$(event.target).closest(".bnrdiv_list li a,.open_bnrdiv").length) {
			$('body').removeClass('bnrdiv_back_1');
			$('body').removeClass('bnrdiv_back_2');
			$('.bnrdiv_dimm').remove();
		}
	});

	$(".bnrdiv_tab_wrap  h3   a").on('click keyup',function(){//mouseenter
		$(".bnrdiv_tab_wrap  h3").removeClass("on");
		$(".bnrdiv_tab_wrap  h3").next().css("display","none");
		$(this).parent().addClass("on");
		$(this).parent().next().fadeIn();
		return false;
	});

});
/*
$(window).on('hashchange', function(e){
	//if (location.pathname.replace(/^\//, '') == this.pathname.replace(/^\//, '') || location.hostname == this.hostname) {
		history.replaceState ("", document.title, e.originalEvent.oldURL);
	//});
});
*/
$(function() {
	/*submenu*/
	var $sideNavMenu = $('.side_menu');
	$sideNavMenu.find('a').on('click', function() {
		if ($(this).parent('li').is('.active')) {
			$(this).siblings('ul').slideUp(100, function() {
				$(this).parent('li').removeClass('active');
			});
			$(this).find('.tree_open').text("하위메뉴 축소됨");
		} else {
			$(this).closest('ul').find('li').removeClass('active').find('>ul').hide();
			$(this).siblings('ul').hide().slideDown(100, function() {
				$(this).parent('li').addClass('active');
			});
			$(this).find('.tree_open').text("하위메뉴 확장됨");
		}
	});

	$sideNavMenu.find('a').each(function(){
		if($(this).parent("li").is(".active")){
			$(this).find('.tree_open').text("하위메뉴 확장됨");
		} else {
			$(this).find('.tree_open').text("하위메뉴 축소됨");
		}
	});
	/*mobile submenu*/
	$(".m_sub_tit .m_btnSubShow").click(function(){
		$("#side_nav").toggle();
		$(".m_sub_tit h3").toggleClass('on');
	});
	/*mobile top menu start*/
	var $header = $('#head_nav');
	var $nav = $('#top_nav');


	$header.find('.btn_nav').off('click').on('click', function() {
		$nav.addClass('opened').attr({'tabindex':'0','hidefocus':'true'}).css('outline','0').focus();

		if (!$header.is(':has(.topNavBackDv)')) {
				$header.append('<div class="topNavBackDv" />');
			}
			$('body').addClass('opened-topNav');
			setTimeout(function(){
				$nav.addClass("fadein")
			},0);

	}).end().find('#m_nav_head .btn_nav_x').on('click', function() {

		$nav.removeClass('fadein');
		$('.topNavBackDv').remove();
		$('body').removeClass('opened-topNav');
		$header.find('.btn_nav').focus();
		setTimeout(function(){
			$nav.removeClass('opened');
		},200);
	});
	$(document).click(function(event) {
		if (!$(event.target).closest("#top_nav,.btn_nav").length) {
			$('body').removeClass('opened-topNav');
			$('.topNavBackDv').remove();
			$('#top_nav').removeClass('opened fadin');
		}
	});

	function checkWidth(init)
	{
		if ($(window).width() < 1025) {
			$( "#head_bar .wrapper").detach(' #google_translate_element');
			$( "#m_nav_member" ).append( $( "#google_translate_element" ) );

		}
		else {
			if (!init) {
				$('body').removeClass('opened-topNav');
				$('.topNavBackDv').remove();
				$('#top_nav').removeClass('opened fadin');
				$( "#m_nav_member").detach(' #google_translate_element');
				$( "#head_bar .wrapper" ).append( $( "#google_translate_element" ) );

			}
		}
	}
	checkWidth(true);
	$(window).resize(function() {
		checkWidth(false);
	});

	var $topNavMenu = $('.top_menu');
	$topNavMenu.find('a').on('click', function() {
		if ($(this).parent('li').is('.active')) {
			$(this).siblings('ul').slideUp(100, function() {
				$(this).parent('li').removeClass('active');
			});
			$(this).find('.tree_open').text("하위메뉴 축소됨");
		} else {
			$(this).closest('ul').find('li').removeClass('active').find('>ul').hide();
			$(this).siblings('ul').hide().slideDown(100, function() {
				$(this).parent('li').addClass('active');
			});
			$(this).find('.tree_open').text("하위메뉴 확장됨");
		}
	});

	$topNavMenu.find('a').each(function(){
		if($(this).parent("li").is(".active")){

			$(this).find('.tree_open').text("하위메뉴 확장됨");

		} else {
			$(this).find('.tree_open').text("하위메뉴 축소됨");

		}
	});

	/*mobile top menu end*/
	$('.m_weather_btn,.m_weather_x').click(function(e){
		$('#weather').toggle();
	});

	$(".post_tabnews  h3   a.tab_lnker").on('click keyup',function(){//mouseenter
		$(".post_tabnews  h3").removeClass("on");
		$(".post_tabnews  h3").next().css("display","none");
		$(this).parent().addClass("on");
		$(this).parent().next().fadeIn();
		$(".post_box_slider").slick("setPosition");
		return false;
	});
	/* google tranlator select lable title */
	//$( '#head_bar #google_translate_element .goog-te-gadget select.goog-te-combo').attr('id', 'goog-te-combo' );
	//$('#google_translate_element').prepend('<label for="goog-te-combo" class="hide">select language</label>');



	//video Tab 장영실만화

	$(".videoArea").hide(); //Hide all content
	$("ul.videoTab li:first").addClass("active").show(); //Activate first tab
	$(".videoArea:first").show(); //Show first tab content
	//On  Event
	$("ul.videoTab li").click(function() {
		$("ul.videoTab li").removeClass("active"); //Remove any "active" class
		$(this).addClass("active"); //Add "active" class to selected tab
		$(".videoArea").hide(); //Hide all tab content

		var activeTab = $(this).find("a").attr("href"); //Find the href attribute value to identify the active tab + content
		$(activeTab).fadeIn().attr("tabindex", 0).focus(); //Fade in the active ID content
		return false;
	});

});